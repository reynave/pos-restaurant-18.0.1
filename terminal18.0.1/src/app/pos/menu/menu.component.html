<div class="">
   <div class="row g-0">
      <div class="col-5 col-lg-4">
         <!-- TABLE cart -->
         <div class="wrapper">
            <div class="py-5">
               <table class="table table-hover">
                  <tbody *ngFor="let x of cartOrdered; let i = index" [class]="{'tr-active':x.checkBox == 1 }">
                     <tr [class]="{'bg-light':x.sendOrder !== ''}">
                        <td (click)="fnChecked(i)  "> 
                           <h4> <i class="bi bi-receipt"></i> </h4> 
                        </td>

                        <td [routerLink]="['/menu/modifier']"
                           [queryParams]="{id:id, menuId : x.menuId, price : x.price, sendOrder : x.sendOrder }">
                           <div class="lh-1">
                              <strong>{{x.name }} {{x.modifier.length > 0 ? '*':''}} </strong>
                           </div>
                           <small class="font-monospace">&#64;{{x.price | number}}</small> 
                        </td>

                        <td class="text-end font-monospace"> 
                              x {{x.total | number}} 
                        </td>

                        <td class="text-end font-monospace">{{(x.totalAmount < 0 ? 0 : x.totalAmount )| number}}</td>
                     </tr>

                     @if(showModifier && x.modifier.length > 0){
                     <tr *ngFor="let a of x.modifier; let i = index">
                        <td></td>
                        <td>
                           <div class="lh-1"> {{ a.descl}} </div>
                           <small class="font-monospace">&#64;{{x.price | number}}</small>

                        </td>
                        <td class="text-center"><span class="font-monospace"> x {{ a.total}}</span></td>
                        <td class="text-end"> <span class="font-monospace">{{a.totalAmount |number}}</span></td>
                     </tr>
                     }

                  </tbody>

                  <tbody *ngFor="let x of cart; let i = index" [class]="{'tr-active':x.checkBox == 1 }">
                     <tr [class]="{'bg-light':x.sendOrder !== ''}">
                        <td (click)="fnChecked(i)  ">
                           @if(x.sendOrder == 0){
                           <h3>
                              <i *ngIf="x.checkBox == 0 " class="bi bi-square"></i>
                              <i *ngIf="x.checkBox == 1 " class="bi bi-check-square-fill"></i>
                           </h3>
                           }
                           @else {
                           <h4> <i class="bi bi-receipt"></i> </h4>
                           }
                        </td>

                        <td [routerLink]="['/menu/modifier']"
                           [queryParams]="{id:id, menuId : x.menuId, price : x.price, sendOrder : x.sendOrder }">
                           <div class="lh-1">
                              <strong>{{x.name }} {{x.modifier.length > 0 ? '*':''}} </strong>
                           </div>
                           <small class="font-monospace">&#64;{{x.price | number}}</small>


                        </td>

                        <td class="text-end font-monospace">
                           <button type="button" class="btn  btn-light border" style="width: 60px;"
                              [disabled]="x.sendOrder == 1" (click)="open(modalQty, x, i)">
                              x {{x.total | number}}
                           </button>
                        </td>

                        <td class="text-end font-monospace">{{(x.totalAmount < 0 ? 0 : x.totalAmount )| number}}</td>
                     </tr>

                     @if(showModifier && x.modifier.length > 0){
                     <tr *ngFor="let a of x.modifier; let i = index">
                        <td></td>
                        <td>
                           <div class="lh-1"> {{ a.descl}} </div>
                           <small class="font-monospace">&#64;{{x.price | number}}</small>

                        </td>
                        <td class="text-center"><span class="font-monospace"> x {{ a.total}}</span></td>
                        <td class="text-end"> <span class="font-monospace">{{a.totalAmount |number}}</span></td>
                     </tr>
                     }

                  </tbody>

               </table>

            </div>


         </div>
      </div>

      <div class="col-7 col-lg-8">
         <div class="wrapper border px-3 py-5">
            <div class="mb-3">

               <button type="button" class="btn btn-danger me-1 mb-1" [disabled]="!isChecked" (click)="onVoid()">VOID
                  ITEM</button>

               <button type="button" class="btn btn-success me-1 mb-1">APPLY ITEM DISCOUNT</button>
               <button type="button" class="btn btn-success me-1 mb-1" [routerLink]="['/bill']"
                  [queryParams]="{id : id}"> BILL</button>
               <button type="button" class="btn btn-warning me-1 mb-1" (click)="payment()"> PAYMENT</button>


               <button type="button" class="btn btn-success me-1 mb-1" [disabled]="items.length < 1"
                  (click)="sendOrder();">SEND ORDER</button>

               <button type="button" class="btn btn-success me-1 mb-1" (click)="exitWithoutOrder();">Exit Without
                  Order</button>

               <button type="button" class="btn btn-light border me-1 mb-1" [routerLink]="['/tableChecker']"
                  [queryParams]="{id:id}">Table Checker</button>
               <button type="button" class="btn btn-light border me-1 mb-1" [routerLink]="['/kitchen']"
                  [queryParams]="{id:id}">Kitchen</button>
 <button type="button" class="btn btn-light border me-1 mb-1" [routerLink]="['/transaction/detail']"
                  [queryParams]="{id:id}">Transaction Detail</button>

            </div>

            <div class="row border">
               <div class="col-4">
                  <small>Add Menu Item</small>
                  <div *ngFor="let x of items">
                     <div><strong>{{x.desc1}}</strong></div>
                     <ol>
                        <li *ngFor="let a of x.menu">
                           <a href="javascript:;" (click)="addToCart(a)">{{a.name}}</a><br>
                           <small>Tax {{a.taxRate}}%, SC {{a.scRate}}%</small>
                        </li>
                     </ol>
                  </div>
               </div>
               <div class="col-4">
                  <small>Add Memo</small>
                  <div *ngFor="let x of modifiers">
                     <div><strong>{{x.name}}</strong></div>
                     <ol>
                        <li *ngFor="let a of x.detail"><a href="javascript:;" (click)="addToItemModifier(a)">
                              {{a.descl}} (Rp{{a.price | number}})</a>
                        </li>
                     </ol>
                  </div>
               </div>

               <div class="col-4">
                  <small>Add Discount Group</small>
                  <div><strong>Discount Group</strong></div>
                  <div *ngFor="let a of discountGroup">
                     <a href="javascript:;" (click)="addDiscountGroup(a)">{{a.name}}</a>
                  </div>
               </div>
            </div>



         </div>
      </div>
   </div>
</div>

<div class="wrapper-fix-bottom border-top shadow-sm bg-white">
   <div class="p-2">
      <div class="row">
         <div class="col-5 col-lg-4">
            <div class="row">
               <div class="col-6">
                  <a class="btn" (click)="showModifier == false ? showModifier = true : showModifier = false">
                     <i *ngIf="showModifier == false " class="bi bi-square"></i>
                     <i *ngIf="showModifier == true " class="bi bi-check-square-fill"></i>
                     Show modifier</a>
               </div>
               <div class="col-6">
                  <h4 class="text-end font-monospace">{{totalAmount + totalAmountOrdered | number}}</h4>
               </div>
            </div>

         </div>
         <div class="col-7 col-lg-8">
            <a href="javascript:;" (click)="reload()"> Developer Reload</a>
         </div>
      </div>
   </div>
</div>

<ng-template #modalQty let-modal>
   <div class="modal-header">
      <strong>Change New Item Quantity </strong>
      <button type="button" class="btn-close" aria-label="Close" (click)="modal.dismiss('Cross click')"></button>
   </div>
   <div class="modal-body">

      <form (ngSubmit)="updateQty()" #actorForm="ngForm">
         <div class="mb-3">
            <div class="mb-1"><label for="newQty">Input New Quantity</label></div>

            <input type="number" class="form-control form-control-lg" id="newQty" required [(ngModel)]="model.newQty"
               name="newQty" #newQty="ngModel">
            <div [hidden]="newQty.valid || newQty.pristine" class="text-danger">
               Input New Quantity is required
            </div>
         </div>
         <div class="text-center">
            <button type="button" class="btn btn-outline-secondary mx-2" style="width: 100px;"
               (click)="modal.close('Save click')">Cancel</button>
            <button type="submit" class="btn btn-dark  mx-2" style="width: 100px;"
               [disabled]="!actorForm.form.valid">OK</button>
         </div>
      </form>
   </div>

</ng-template>


<ng-template #modalAddMemo let-modal>
   <div class="modal-header">
      <strong>Change New Item Quantity </strong>
      <button type="button" class="btn-close" aria-label="Close" (click)="modal.dismiss('Cross click')"></button>
   </div>
   <div class="modal-body">

      <form (ngSubmit)="updateQty()" #actorForm="ngForm">
         <div class="mb-3">
            <div class="mb-1"><label for="newQty">Input New Quantity</label></div>

            <input type="number" class="form-control form-control-lg" id="newQty" required [(ngModel)]="model.newQty"
               name="newQty" #newQty="ngModel">
            <div [hidden]="newQty.valid || newQty.pristine" class="text-danger">
               Input New Quantity is required
            </div>
         </div>
         <div class="text-center">
            <button type="button" class="btn btn-outline-secondary mx-2" style="width: 100px;"
               (click)="modal.close('Save click')">Cancel</button>
            <button type="submit" class="btn btn-dark  mx-2" style="width: 100px;"
               [disabled]="!actorForm.form.valid">OK</button>
         </div>
      </form>
   </div>

</ng-template>