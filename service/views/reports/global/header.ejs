<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">

  <title>
    <%= report.title || 'Laporan' %>
  </title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
  <style>
    body {
      font-family: 'Courier New', Courier, monospace;
      font-size: 0.9rem;
      margin: 12px;
      color: #000;
    }

    h1 {
      font-size: 2rem;
      padding: 0px;
      margin: 0px;
      list-style: 100%;
    }

    h2 {
      font-size: 1.3rem;
      list-style: 100%;
    }

    h3,
    h4 {
      font-size: 1rem;
      list-style: 100%;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 8px;
    }

    .table-sm>:not(caption)>*>* {
      padding: 0px;
    }

    th {
      border-bottom: 1px solid #000;
      font-size: 0.8rem;
      text-align: left;

    }

    td {
      font-size: 0.8rem;
      padding: 0px;

    }

tfoot td {
      border-top: 1px solid #000;
    } 

    .right {
      text-align: right;
    }

    .report-header {
      margin-bottom: 8px;
    }



    /* Print / A4 paper styling */
    @media print {
      @page {
        size: A4 portrait;
        margin: 10mm 12mm;
        /* top/bottom 10mm, left/right 12mm */
      }

      html,
      body {
        width: 210mm;
        height: 297mm;
        margin-top: 5mm;
      }

      /* Make the report fill an A4 page with a visible border */
      .report {
        box-sizing: border-box;
        width: 210mm;
        min-height: 297mm;

        margin: 0 auto;
      }

      /* Avoid breaking table rows across pages */
      table {
        page-break-inside: auto;
      }

      tr {
        page-break-inside: avoid;
        page-break-after: auto
      }

      thead {
        display: table-header-group;
      }

      tfoot {
        display: table-footer-group;
      }

      /* Utility for forcing a page break */
      .page-break {
        page-break-after: always;
      }

      .no-print {
        display: none;
      }
    }

    .no-print {
      position: fixed;
      top: 10px;
      right: 10px;
      z-index: 1000;
    }

    /* Optional on-screen preview: constrain width similar to A4 */
    @media screen {
      .report {
        max-width: 1024px;
        margin: 10px auto;
        padding: 12px;
      }
    }
  </style>
</head>

<body class="report">
  <div class="no-print">
    <button onclick="window.print()">Print</button>
  </div>
  <div class="container">
    <div class="row mb-3">
      <div class="col-12 text-center">
        <div> PT. Mitrasys Bisnis Sinergi (FOR DEMO ONLY)</div>
        <h1>
          <%= report.title %>
        </h1>
        <div>
          <%= report.startDate %> to <%= report.endDate %>
        </div>
      </div>
    </div>

    <div class="row mb-3">

      <div class="col-4">
        <% const d=new Date(report.header.inputDate); const pad=n=> String(n).padStart(2, '0');
          const formatted = isNaN(d) ? report.header.inputDate :
          `${pad(d.getDate())}-${pad(d.getMonth()+1)}-${d.getFullYear()}
          ${pad(d.getHours())}:${pad(d.getMinutes())}:${pad(d.getSeconds())}`;
          %>
          Printed At: <%= formatted %>
      </div>
      <div class="col-4 text-center">
        Printed By : <%= report.header.createdName %>
      </div>
      <div class="col-4 text-end">
        Served : <%= report.data.filter.employee  %>
      </div>

    </div>
  </div>

  </div>